"use strict";(self.webpackChunkadmin_fashional_pro=self.webpackChunkadmin_fashional_pro||[]).push([[40],{7040:function(e,n,t){t.r(n),t.d(n,{default:function(){return Q}});var a=t(1413),i=t(1156),s=t(3654),r=t(6871),c=t(5173),l=t(1933),o=t(9965),d=t(2235),u=t(5280),m=t(5366),h=t(763),x=t(5861),f=t(2982),p=t(4687),j=t.n(p),v=t(1918),g=t(3239),b=t(184),y=function(){var e=(0,r.UO)().id,n=(0,u.GS)().handlePostMedia,t=(0,c.TA)({initialValues:{medias:[]},onSubmit:function(e){}}),a=t.values,s=t.setFieldValue,h=(0,l.useQuery)({queryKey:[o.xG.product_media,e],queryFn:function(){return d.Qe.findMedias(e||0)},enabled:!!e,onSuccess:function(e){var n;return s("medias",null===(n=e.context.data)||void 0===n?void 0:n.map((function(e){return e.media})))}}),p=h.refetch,y=h.isFetching,N=(0,l.useMutation)({mutationFn:function(n){return d.Qe.createProductMedias(e||0,n)}}),_=N.mutate,C=N.isLoading,k=function(){var e=(0,x.Z)(j().mark((function e(n){return j().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s("medias",a.medias.filter((function(e){return e.id!==n}))),e.next=3,d.Qe.deleteProductMedias(n||0,{media_ids:[n]});case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,b.jsxs)("div",{className:"card p-4 my-4",children:[(0,b.jsx)("span",{className:"text-dark fw-bold fs-6",children:"Th\u01b0 vi\u1ec7n \u1ea3nh"}),(0,b.jsxs)("div",{className:"mt-2 product-media",children:[a.medias.map((function(e,n){return(0,b.jsxs)("div",{className:"media-item",children:["video/mp4"===e.mime_type?(0,b.jsx)("video",{controls:!0,children:(0,b.jsx)("source",{src:e.original_url})}):(0,b.jsx)("img",{src:e.original_url,alt:""}),e.id>0?(0,b.jsx)(v.Z,{color:"error",variant:"filled",onDelete:function(){return k(e.id)}}):(0,b.jsx)("div",{className:"item-image-load d-flex justify-content-center align-items-center",children:(0,b.jsx)(g.Z,{size:26})})]},n)})),(0,b.jsx)("div",{className:"media-item d-flex justify-content-center align-items-center",children:(0,b.jsx)(i.vA,{id:"medias",onChange:function(e){n({e:e,callBack:function(e){s("medias",[].concat((0,f.Z)(a.medias),(0,f.Z)(e)))}})},multi:!0})})]}),(0,b.jsxs)("div",{className:"d-flex justify-content-end mt-6",children:[(0,b.jsx)(m.Z,{disabled:!e,onClick:function(){return _({media_ids:a.medias.map((function(e){return e.id}))})},loading:C,type:"button",color:"success",variant:"contained",children:"L\u01b0u"}),e&&(0,b.jsx)(m.Z,{disabled:!e,onClick:function(){return p()},loading:y,className:"mx-2",type:"button",variant:"outlined",children:"Kh\xf4i ph\u1ee5c"})]})]})},N=t(885),_=t(2426),C=t.n(_),k=t(2791),S=t(1724),q=function(){var e,n=(0,r.UO)().id,t=(0,l.useQueryClient)(),u=(0,l.useQuery)({queryKey:[o.xG.product_branch,n],queryFn:function(){return d.Qe.findBranches(n||0)},enabled:!!n}).data,h=(0,l.useMutation)({mutationFn:function(e){return d.Qe.createBranch(n||0,e)},onSuccess:function(){return t.invalidateQueries([o.xG.product_branch,n])}}),f=h.mutateAsync,p=h.isLoading,v=(0,c.TA)({initialValues:{branch_id:"",quantity:1},validationSchema:S.Ry({branch_id:S.Z_().required(),quantity:S.Rx().required()}),onSubmit:function(){var e=(0,x.Z)(j().mark((function e(n){return j().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f((0,a.Z)((0,a.Z)({},n),{},{branch_id:Number(n.branch_id)}));case 2:C();case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()}),g=v.values,y=v.setFieldValue,N=v.handleChange,_=v.handleSubmit,C=v.resetForm;return(0,b.jsxs)("div",{className:"card p-4 my-4",children:[(0,b.jsx)("span",{className:"text-dark fw-bold fs-6",children:"Chi nh\xe1nh"}),(0,b.jsx)("div",{className:"card-body py-3",children:(0,b.jsxs)("div",{className:"table-responsive",children:[(0,b.jsx)(i.uR,{permissionPath:s.yB.POST_BRANCH,children:(0,b.jsxs)("form",{className:"d-flex align-items-center mb-4",onSubmit:_,children:[(0,b.jsx)(i.N5,{value:g.branch_id||"",onChange:function(e){return y("branch_id",e.target.value)}}),(0,b.jsx)("input",{type:"number",className:"form-control form-control-solid py-2 px-3",style:{width:"120px",margin:"0px 8px"},value:g.quantity,name:"quantity",onChange:N}),(0,b.jsx)(m.Z,{loading:p,disabled:!n,size:"medium",color:"success",variant:"contained",type:"submit",children:"Th\xeam chi nh\xe1nh"})]})}),(0,b.jsxs)("table",{className:"table align-middle gs-0 gy-4",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"fw-bold text-muted bg-light",children:[(0,b.jsx)("th",{className:"ps-4 min-w-300px rounded-start",children:"Chi nh\xe1nh"}),(0,b.jsx)("th",{className:"min-w-125px",children:"S\u1ed1 l\u01b0\u1ee3ng"}),(0,b.jsx)("th",{className:"min-w-125px",children:"Tr\u1ea1ng th\xe1i"}),(0,b.jsx)("th",{className:"min-w-200px",children:"Ng\xe0y t\u1ea1o"}),(0,b.jsx)("th",{className:"min-w-200px text-end rounded-end"})]})}),(0,b.jsx)("tbody",{children:null===u||void 0===u||null===(e=u.context.data)||void 0===e?void 0:e.map((function(e,n){return(0,b.jsx)(w,{item:e},n)}))})]})]})})]})},w=function(e){var n,t=e.item,a=(0,r.UO)().id,c=(0,l.useQueryClient)(),m=(0,k.useState)(t.quantity),h=(0,N.Z)(m,2),x=h[0],f=h[1],p=(0,u.gI)(s.yB.PUT_BRANCH).resolve,j=(0,l.useMutation)({mutationFn:function(e){return d.Qe.updateBranch(a||0,t.branch.id,e)},onSuccess:function(){c.invalidateQueries([o.xG.product_branch,a])}}),v=j.mutate,g=j.isLoading,y=(0,l.useMutation)({mutationFn:function(){return d.Qe.deleteBranch(a||0,t.branch.id)},onSuccess:function(){return c.invalidateQueries([o.xG.product_branch,a])}}),_=y.mutate,S=y.isLoading;return(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("span",{className:"text-dark fw-bold mb-1 fs-6",children:null===(n=t.branch)||void 0===n?void 0:n.name})}),(0,b.jsx)("td",{children:(0,b.jsx)("input",{type:"number",className:"form-control form-control-solid",value:x,onChange:function(e){return f(Number(e.target.value))}})}),(0,b.jsx)("td",{children:(0,b.jsx)(i.U3,{disable:!p,value:t.status,onChange:function(e){return v({status:e.target.checked})}})}),(0,b.jsx)("td",{children:(0,b.jsx)("span",{className:"text-muted fw-semobold text-muted d-block fs-7",children:C()(t.created_at).format("DD/MM/YYYY")})}),(0,b.jsxs)("td",{className:"text-end",children:[(0,b.jsx)(i.uR,{permissionPath:s.yB.PUT_BRANCH,children:(0,b.jsx)("button",{type:"button",onClick:function(){return v({quantity:x})},className:"btn btn-icon btn-success me-1 rounded-circle btn-sm",children:g?(0,b.jsx)(i.fC,{}):(0,b.jsx)("i",{className:"fa fa-check fs-6"})})}),(0,b.jsx)(i.uR,{permissionPath:s.yB.DELETE_BRANCH,children:(0,b.jsx)("button",{onClick:function(){return _()},className:"btn btn-icon btn-danger me-1 rounded-circle btn-sm",children:S?(0,b.jsx)(i.fC,{}):(0,b.jsx)("i",{className:"bi bi-trash-fill fs-6"})})})]})]})};var B=function(){return(0,b.jsx)("div",{className:"card p-4 my-4",children:(0,b.jsx)("span",{className:"text-dark fw-bold fs-6",children:"Size/lo\u1ea1i"})})},Q=function(){var e=(0,r.UO)().id,n=(0,r.s0)(),t=(0,u.UD)(),x=t.result,f=t.notification,p=f.message,j=f.color,v=f.openAlert,g=t.onClose,N=(0,u.GS)(),_=N.handlePostMedia,C=N.isLoading,k=(0,l.useMutation)({mutationFn:function(n){return e?d.Qe.update(e,n):d.Qe.create(n)},onSuccess:function(t){x({message:e?"C\u1eadp nh\u1eadt th\xe0nh c\xf4ng":"T\u1ea1o m\u1edbi th\xe0nh c\xf4ng",color:"success"}),e||setTimeout((function(){n(s.$c.update_id(t.context.id))}))},onError:function(e){var n;x({message:(null===(n=e.response)||void 0===n?void 0:n.data.message)||"C\xf3 l\u1ed7i x\u1ea3y ra",color:"error"})}}),S=k.mutate,w=k.isLoading,Q=(0,c.TA)({initialValues:{name:"",status:!0,thumbnail_url:"",price_original:void 0,price:void 0,price_special:void 0,short_content:"",tag_id:void 0,category_id:void 0},onSubmit:function(e){var n=(0,h.pickBy)(e,h.identity);S((0,a.Z)((0,a.Z)({},n),{},{status:e.status}))}}),T=Q.values,Z=Q.errors,F=Q.touched,M=Q.setFieldValue,P=Q.handleChange,A=Q.handleSubmit,G=(0,l.useQuery)({queryKey:[o.xG.product,e],queryFn:function(){return d.Qe.findById(e||0)},enabled:!!e,onSuccess:function(e){var n=e.context,t=n.name,a=n.thumbnail_url,i=n.status,s=n.price_original,r=n.price,c=n.price_special,l=n.short_content,o=n.tag_id,d=n.category_id;M("name",t),M("status",i),M("thumbnail_url",a),M("price_original",s),M("price",r),M("price_special",c),M("short_content",l),M("tag_id",o),M("category_id",d)}}),R=G.isFetching,U=G.refetch;return(0,b.jsx)(i.uR,{permissionPath:e?s.yB.PUT:s.yB.POST,children:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(i.V1,{title:e?"Thay \u0111\u1ed5i th\xf4ng tin s\u1ea3n ph\u1ea9m":""}),(0,b.jsx)(i.rH,{open:v,message:p,severity:j,onClose:g}),(0,b.jsx)("div",{className:"card p-4",children:(0,b.jsxs)("form",{onSubmit:A,className:"form",children:[(0,b.jsx)("div",{className:"my-3 d-flex justify-content-center",children:(0,b.jsxs)("div",{className:"avatar-image",children:[(0,b.jsx)("img",{src:T.thumbnail_url||"",alt:""}),(0,b.jsx)("div",{className:"btn-avatar-cnt",children:(0,b.jsx)(i.vA,{loading:C,onChange:function(e){_({e:e,resetOriginalResult:!0,callBack:function(e){return M("thumbnail_url",e[0].original_url)}})},id:"file_avatar"})})]})}),(0,b.jsx)("div",{className:"column my-3",children:(0,b.jsx)(i.U3,{value:T.status,onChange:function(e){return M("status",e.target.checked)},label:"Tr\u1ea1ng th\xe1i"})}),(0,b.jsxs)("div",{className:"column my-3",children:[(0,b.jsx)("label",{className:"form-label required",children:"T\xean s\u1ea3n ph\u1ea9m"}),(0,b.jsx)("input",{type:"text",className:"form-control form-control-solid",name:"name",value:T.name,onChange:P})]}),(0,b.jsxs)("div",{className:"d-flex justify-content-between row-3",children:[(0,b.jsxs)("div",{className:"column my-3",children:[(0,b.jsx)("label",{className:"form-label required",children:"Gi\xe1 nh\u1eadp"}),(0,b.jsx)("input",{type:"number",className:"form-control form-control-solid",name:"price_original",value:T.price_original||"",onChange:function(e){Number(e.target.value)>=0&&M("price_original",Number(e.target.value))}})]}),(0,b.jsxs)("div",{className:"column my-3",children:[(0,b.jsx)("label",{className:"form-label required",children:"Gi\xe1 b\xe1n"}),(0,b.jsx)("input",{type:"text",className:"form-control form-control-solid",name:"price",value:T.price||"",onChange:function(e){Number(e.target.value)>=0&&M("price",Number(e.target.value))}})]}),(0,b.jsxs)("div",{className:"column my-3",children:[(0,b.jsx)("label",{className:"form-label required",children:"Gi\xe1 \u01b0u \u0111\xe3i"}),(0,b.jsx)("input",{type:"text",className:"form-control form-control-solid",name:"price_special",value:T.price_special||"",onChange:function(e){0<=Number(e.target.value)&&Number(e.target.value)<=Number(T.price)&&M("price_special",Number(e.target.value))}})]})]}),(0,b.jsxs)("div",{className:"column my-3",children:[(0,b.jsx)("label",{className:"form-label required",children:"M\xf4 t\u1ea3"}),(0,b.jsx)("input",{type:"text",className:"form-control form-control-solid",name:"short_content",value:T.short_content,onChange:P})]}),(0,b.jsxs)("div",{className:"d-flex row-2",children:[(0,b.jsxs)("div",{className:"column  my-3",children:[(0,b.jsx)("label",{className:"form-label required",children:"Tag"}),(0,b.jsx)("div",{className:"column",children:(0,b.jsx)(i.Sp,{value:T.tag_id,onChange:function(e){M("tag_id",e.target.value),M("category_id","")}})}),F.tag_id&&Z.tag_id&&(0,b.jsx)("span",{className:"text-danger fs-8",children:Z.tag_id})]}),(0,b.jsxs)("div",{className:"column  my-3",children:[(0,b.jsx)("label",{className:"form-label required",children:"Danh m\u1ee5c d\u1ecbch v\u1ee5"}),(0,b.jsx)("div",{className:"column",children:(0,b.jsx)(i.ms,{tag_id:T.tag_id,disabled:!T.tag_id||""===T.tag_id,value:T.category_id,onChange:function(e){return M("category_id",e.target.value)}})})]})]}),(0,b.jsxs)("div",{className:"d-flex justify-content-end mt-6",children:[(0,b.jsx)(m.Z,{loading:w,type:"submit",color:"success",variant:"contained",children:"L\u01b0u"}),e&&(0,b.jsx)(m.Z,{onClick:function(){return U()},loading:R,className:"mx-2",type:"button",variant:"outlined",children:"Kh\xf4i ph\u1ee5c"})]})]})}),(0,b.jsx)(y,{}),(0,b.jsx)(q,{}),(0,b.jsx)(B,{})]})})}}}]);
//# sourceMappingURL=40.9357083b.chunk.js.map