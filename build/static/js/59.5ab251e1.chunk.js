"use strict";(self.webpackChunkadmin_fashional_pro=self.webpackChunkadmin_fashional_pro||[]).push([[59],{6486:function(e,n,t){t.r(n),t.d(n,{default:function(){return Z}});var i=t(1413),a=t(1156),s=t(3654),r=t(6871),c=t(5173),l=t(1933),d=t(9965),o=t(7063),u=t(5280),m=t(5366),h=t(763),x=t(5861),f=t(2982),p=t(4687),j=t.n(p),b=t(1918),v=t(3239),g=t(184),y=function(){var e=(0,r.UO)().id,n=(0,u.GS)().handlePostMedia,t=(0,c.TA)({initialValues:{medias:[]},onSubmit:function(e){}}),i=t.values,s=t.setFieldValue,h=(0,l.useQuery)({queryKey:[d.xG.product_media,e],queryFn:function(){return o.Qe.findMedias(e||0)},enabled:!!e,onSuccess:function(e){var n;return s("medias",null===(n=e.context.data)||void 0===n?void 0:n.map((function(e){return e.media})))}}),p=h.refetch,y=h.isFetching,N=(0,l.useMutation)({mutationFn:function(n){return o.Qe.createProductMedias(e||0,n)}}),_=N.mutate,C=N.isLoading,S=function(){var e=(0,x.Z)(j().mark((function e(n){return j().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s("medias",i.medias.filter((function(e){return e.id!==n}))),e.next=3,o.Qe.deleteProductMedias(n||0,{media_ids:[n]});case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,g.jsxs)("div",{className:"card p-4 my-4",children:[(0,g.jsx)("span",{className:"text-dark fw-bold fs-6",children:"Th\u01b0 vi\u1ec7n \u1ea3nh"}),(0,g.jsxs)("div",{className:"mt-2 product-media",children:[i.medias.map((function(e,n){return(0,g.jsxs)("div",{className:"media-item",children:["video/mp4"===e.mime_type?(0,g.jsx)("video",{controls:!0,children:(0,g.jsx)("source",{src:e.original_url})}):(0,g.jsx)("img",{src:e.original_url,alt:""}),e.id>0?(0,g.jsx)(b.Z,{color:"error",variant:"filled",onDelete:function(){return S(e.id)}}):(0,g.jsx)("div",{className:"item-image-load d-flex justify-content-center align-items-center",children:(0,g.jsx)(v.Z,{size:26})})]},n)})),(0,g.jsx)("div",{className:"media-item d-flex justify-content-center align-items-center",children:(0,g.jsx)(a.vA,{id:"medias",onChange:function(e){n({e:e,callBack:function(e){s("medias",[].concat((0,f.Z)(i.medias),(0,f.Z)(e)))}})},multi:!0})})]}),(0,g.jsxs)("div",{className:"d-flex justify-content-end mt-6",children:[(0,g.jsx)(m.Z,{disabled:!e,onClick:function(){return _({media_ids:i.medias.map((function(e){return e.id}))})},loading:C,type:"button",color:"success",variant:"contained",children:"L\u01b0u"}),e&&(0,g.jsx)(m.Z,{disabled:!e,onClick:function(){return p()},loading:y,className:"mx-2",type:"button",variant:"outlined",children:"Kh\xf4i ph\u1ee5c"})]})]})},N=t(885),_=t(2426),C=t.n(_),S=t(2791),w=t(1724),k=function(){var e,n=(0,r.UO)().id,t=(0,l.useQueryClient)(),u=(0,l.useQuery)({queryKey:[d.xG.product_branch,n],queryFn:function(){return o.Qe.findBranches(n||0)},enabled:!!n}).data,h=(0,l.useMutation)({mutationFn:function(e){return o.Qe.createBranch(n||0,e)},onSuccess:function(){return t.invalidateQueries([d.xG.product_branch,n])}}),f=h.mutateAsync,p=h.isLoading,b=(0,c.TA)({initialValues:{branch_id:"",quantity:1},validationSchema:w.Ry({branch_id:w.Z_().required(),quantity:w.Rx().required()}),onSubmit:function(){var e=(0,x.Z)(j().mark((function e(n){return j().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f((0,i.Z)((0,i.Z)({},n),{},{branch_id:Number(n.branch_id)}));case 2:C();case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()}),v=b.values,y=b.setFieldValue,N=b.handleChange,_=b.handleSubmit,C=b.resetForm;return(0,g.jsxs)("div",{className:"card p-4 my-4",children:[(0,g.jsx)("span",{className:"text-dark fw-bold fs-6",children:"Chi nh\xe1nh"}),(0,g.jsx)("div",{className:"card-body p-2",children:(0,g.jsxs)("div",{className:"table-responsive",children:[(0,g.jsx)(a.uR,{permissionPath:s.yB.POST_BRANCH,children:(0,g.jsxs)("form",{className:"d-flex align-items-center mb-4",onSubmit:_,children:[(0,g.jsx)(a.N5,{value:v.branch_id||"",onChange:function(e){return y("branch_id",e.target.value)}}),(0,g.jsx)("input",{type:"number",className:"form-control form-control-solid py-2 px-3",style:{width:"120px",margin:"0px 8px"},value:v.quantity,name:"quantity",onChange:N}),(0,g.jsx)(m.Z,{loading:p,disabled:!n,size:"medium",color:"success",variant:"contained",type:"submit",children:"Th\xeam chi nh\xe1nh"})]})}),(0,g.jsxs)("table",{className:"table align-middle gs-0 gy-4",children:[(0,g.jsx)("thead",{children:(0,g.jsxs)("tr",{className:"fw-bold text-muted bg-light",children:[(0,g.jsx)("th",{className:"ps-4 min-w-300px rounded-start",children:"Chi nh\xe1nh"}),(0,g.jsx)("th",{className:"min-w-125px",children:"S\u1ed1 l\u01b0\u1ee3ng"}),(0,g.jsx)("th",{className:"min-w-125px",children:"Tr\u1ea1ng th\xe1i"}),(0,g.jsx)("th",{className:"min-w-200px",children:"Ng\xe0y t\u1ea1o"}),(0,g.jsx)("th",{className:"min-w-200px text-end rounded-end"})]})}),(0,g.jsx)("tbody",{children:null===u||void 0===u||null===(e=u.context.data)||void 0===e?void 0:e.map((function(e,n){return(0,g.jsx)(Q,{item:e},e.branch.id)}))})]})]})})]})},Q=function(e){var n,t=e.item,i=(0,r.UO)().id,c=(0,l.useQueryClient)(),m=(0,S.useState)(t.quantity),h=(0,N.Z)(m,2),x=h[0],f=h[1],p=(0,u.gI)(s.yB.PUT_BRANCH).resolve,j=(0,l.useMutation)({mutationFn:function(e){return o.Qe.updateBranch(i||0,t.branch.id,e)},onSuccess:function(){c.invalidateQueries([d.xG.product_branch,i])}}),b=j.mutate,v=j.isLoading,y=(0,l.useMutation)({mutationFn:function(){return o.Qe.deleteBranch(i||0,t.branch.id)},onSuccess:function(){return c.invalidateQueries([d.xG.product_branch,i])}}),_=y.mutate,w=y.isLoading;return(0,g.jsxs)("tr",{children:[(0,g.jsx)("td",{children:(0,g.jsx)("span",{className:"text-dark fw-bold mb-1 fs-6",children:null===(n=t.branch)||void 0===n?void 0:n.name})}),(0,g.jsx)("td",{children:(0,g.jsx)("input",{type:"number",className:"form-control form-control-solid",value:x,onChange:function(e){return f(Number(e.target.value))}})}),(0,g.jsx)("td",{children:(0,g.jsx)(a.U3,{disable:!p,value:t.status,onChange:function(e){return b({status:e.target.checked})}})}),(0,g.jsx)("td",{children:(0,g.jsx)("span",{className:"text-muted fw-semobold text-muted d-block fs-7",children:C()(t.created_at).format("DD/MM/YYYY")})}),(0,g.jsxs)("td",{className:"text-end",children:[(0,g.jsx)(a.uR,{permissionPath:s.yB.PUT_BRANCH,children:(0,g.jsx)("button",{type:"button",onClick:function(){return b({quantity:x})},className:"btn btn-icon btn-success me-1 rounded-circle btn-sm",children:v?(0,g.jsx)(a.fC,{}):(0,g.jsx)("i",{className:"fa fa-check fs-6"})})}),(0,g.jsx)(a.uR,{permissionPath:s.yB.DELETE_BRANCH,children:(0,g.jsx)("button",{onClick:function(){return _()},className:"btn btn-icon btn-danger me-1 rounded-circle btn-sm",children:w?(0,g.jsx)(a.fC,{}):(0,g.jsx)("i",{className:"bi bi-trash-fill fs-6"})})})]})]})},T=function(){var e,n,t=(0,r.UO)().id,i=(0,l.useQueryClient)(),u=(0,l.useQuery)({queryKey:[d.xG.product_size,t],queryFn:function(){return o.Qe.findSizes(t||0)},enabled:!!t}).data,h=(0,l.useMutation)({mutationFn:function(e){return o.Qe.createSize(t||0,e)},onSuccess:function(){return i.invalidateQueries([d.xG.product_size,t])}}),f=h.mutateAsync,p=h.isLoading,b=(0,c.TA)({initialValues:{name:""},validationSchema:w.Ry({name:w.Z_().required()}),onSubmit:function(){var e=(0,x.Z)(j().mark((function e(n){return j().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f(n);case 2:_();case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()}),v=b.values,y=b.handleChange,N=b.handleSubmit,_=b.resetForm;return(0,g.jsxs)("div",{className:"card p-4 my-4",children:[(0,g.jsx)("span",{className:"text-dark fw-bold fs-6",children:"Size/lo\u1ea1i"}),(0,g.jsx)("div",{className:"card-body p-2",children:(0,g.jsxs)("div",{className:"table-responsive",children:[(0,g.jsx)(a.uR,{permissionPath:s.yB.POST_SIZE,children:(0,g.jsxs)("form",{className:"d-flex align-items-center mb-4",onSubmit:N,children:[(0,g.jsx)("input",{type:"text",className:"form-control form-control-solid py-2 px-3",style:{width:"200px",marginRight:"8px"},placeholder:"T\xean size/loai...",value:v.name,name:"name",onChange:y}),(0,g.jsx)(m.Z,{loading:p,disabled:!t,size:"medium",color:"success",variant:"contained",type:"submit",children:"Th\xeam size/lo\u1ea1i"})]})}),(0,g.jsxs)("table",{className:"table align-middle gs-0 gy-4",children:[(0,g.jsx)("thead",{children:(0,g.jsxs)("tr",{className:"fw-bold text-muted bg-light",children:[(0,g.jsx)("th",{className:"ps-4 min-w-300px rounded-start",children:"T\xean size/lo\u1ea1i"}),(0,g.jsx)("th",{className:"min-w-125px",children:"Tr\u1ea1ng th\xe1i"}),(0,g.jsx)("th",{className:"min-w-100px",children:"C\u1eadp nh\u1eadt"}),(0,g.jsx)("th",{className:"min-w-100px",children:"Ng\xe0y t\u1ea1o"}),(0,g.jsx)("th",{className:"min-w-200px text-end rounded-end"})]})}),(0,g.jsx)("tbody",{children:null===u||void 0===u||null===(e=u.context)||void 0===e||null===(n=e.data)||void 0===n?void 0:n.map((function(e){return(0,g.jsx)(q,{item:e},e.id)}))})]})]})})]})},q=function(e){var n=e.item,t=(0,r.UO)().id,i=(0,l.useQueryClient)(),c=(0,S.useState)(n.name),m=(0,N.Z)(c,2),h=m[0],x=m[1],f=(0,u.gI)(s.yB.PUT_SIZE).resolve,p=(0,l.useMutation)({mutationFn:function(e){return o.Qe.updateSize(t||0,n.id,e)},onSuccess:function(){i.invalidateQueries([d.xG.product_size,t])}}),j=p.mutate,b=p.isLoading,v=(0,l.useMutation)({mutationFn:function(){return o.Qe.deleteSize(t||0,n.id)},onSuccess:function(){return i.invalidateQueries([d.xG.product_size,t])}}),y=v.mutate,_=v.isLoading;return(0,g.jsxs)("tr",{children:[(0,g.jsx)("td",{children:(0,g.jsx)("input",{disabled:!f,type:"text",className:"form-control form-control-solid",value:h,onChange:function(e){return x(e.target.value)}})}),(0,g.jsx)("td",{children:(0,g.jsx)(a.U3,{disable:!f,value:n.status,onChange:function(e){return j({status:e.target.checked})}})}),(0,g.jsx)("td",{children:(0,g.jsx)("span",{className:"text-muted fw-semobold text-muted d-block fs-7",children:C()(n.updated_at).format("DD/MM/YYYY")})}),(0,g.jsx)("td",{children:(0,g.jsx)("span",{className:"text-muted fw-semobold text-muted d-block fs-7",children:C()(n.created_at).format("DD/MM/YYYY")})}),(0,g.jsxs)("td",{className:"text-end",children:[(0,g.jsx)(a.uR,{permissionPath:s.yB.PUT_SIZE,children:(0,g.jsx)("button",{type:"button",onClick:function(){return j({name:h})},className:"btn btn-icon btn-success me-1 rounded-circle btn-sm",children:b?(0,g.jsx)(a.fC,{}):(0,g.jsx)("i",{className:"fa fa-check fs-6"})})}),(0,g.jsx)(a.uR,{permissionPath:s.yB.DELETE_BRANCH,children:(0,g.jsx)("button",{onClick:function(){return y()},className:"btn btn-icon btn-danger me-1 rounded-circle btn-sm",children:_?(0,g.jsx)(a.fC,{}):(0,g.jsx)("i",{className:"bi bi-trash-fill fs-6"})})})]})]})};var Z=function(){var e=(0,r.UO)().id,n=(0,r.s0)(),t=(0,u.UD)(),x=t.result,f=t.notification,p=f.message,j=f.color,b=f.openAlert,v=t.onClose,N=(0,u.GS)(),_=N.handlePostMedia,C=N.isLoading,S=(0,l.useMutation)({mutationFn:function(n){return e?o.Qe.update(e,n):o.Qe.create(n)},onSuccess:function(t){x({message:e?"C\u1eadp nh\u1eadt th\xe0nh c\xf4ng":"T\u1ea1o m\u1edbi th\xe0nh c\xf4ng",color:"success"}),e||setTimeout((function(){n(s.$c.update_id(t.context.id))}))},onError:function(e){var n;x({message:(null===(n=e.response)||void 0===n?void 0:n.data.message)||"C\xf3 l\u1ed7i x\u1ea3y ra",color:"error"})}}),w=S.mutate,Q=S.isLoading,q=(0,c.TA)({initialValues:{name:"",status:!0,thumbnail_url:"",price_original:void 0,price:void 0,price_special:void 0,short_content:"",tag_id:void 0,category_id:void 0},onSubmit:function(e){var n=(0,h.pickBy)(e,h.identity);w((0,i.Z)((0,i.Z)({},n),{},{status:e.status}))}}),Z=q.values,B=q.errors,F=q.touched,M=q.setFieldValue,P=q.handleChange,R=q.handleSubmit,z=(0,l.useQuery)({queryKey:[d.xG.product,e],queryFn:function(){return o.Qe.findById(e||0)},enabled:!!e,onSuccess:function(e){var n=e.context,t=n.name,i=n.thumbnail_url,a=n.status,s=n.price_original,r=n.price,c=n.price_special,l=n.short_content,d=n.tag_id,o=n.category_id;M("name",t),M("status",a),M("thumbnail_url",i),M("price_original",s),M("price",r),M("price_special",c),M("short_content",l),M("tag_id",d),M("category_id",o)}}),G=z.isFetching,U=z.refetch;return(0,g.jsx)(a.uR,{permissionPath:e?s.yB.PUT:s.yB.POST,children:(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(a.V1,{title:e?"Thay \u0111\u1ed5i th\xf4ng tin s\u1ea3n ph\u1ea9m":""}),(0,g.jsx)(a.rH,{open:b,message:p,severity:j,onClose:v}),(0,g.jsx)("div",{className:"card p-4",children:(0,g.jsxs)("form",{onSubmit:R,className:"form",children:[(0,g.jsx)("div",{className:"my-3 d-flex justify-content-center",children:(0,g.jsxs)("div",{className:"avatar-image",children:[(0,g.jsx)("img",{src:Z.thumbnail_url||"",alt:""}),(0,g.jsx)("div",{className:"btn-avatar-cnt",children:(0,g.jsx)(a.vA,{loading:C,onChange:function(e){_({e:e,resetOriginalResult:!0,callBack:function(e){return M("thumbnail_url",e[0].original_url)}})},id:"file_avatar"})})]})}),(0,g.jsx)("div",{className:"column my-3",children:(0,g.jsx)(a.U3,{value:Z.status,onChange:function(e){return M("status",e.target.checked)},label:"Tr\u1ea1ng th\xe1i"})}),(0,g.jsxs)("div",{className:"column my-3",children:[(0,g.jsx)("label",{className:"form-label required",children:"T\xean s\u1ea3n ph\u1ea9m"}),(0,g.jsx)("input",{type:"text",className:"form-control form-control-solid",name:"name",value:Z.name,onChange:P})]}),(0,g.jsxs)("div",{className:"d-flex justify-content-between row-3",children:[(0,g.jsxs)("div",{className:"column my-3",children:[(0,g.jsx)("label",{className:"form-label required",children:"Gi\xe1 nh\u1eadp"}),(0,g.jsx)("input",{type:"number",className:"form-control form-control-solid",name:"price_original",value:Z.price_original||"",onChange:function(e){Number(e.target.value)>=0&&M("price_original",Number(e.target.value))}})]}),(0,g.jsxs)("div",{className:"column my-3",children:[(0,g.jsx)("label",{className:"form-label required",children:"Gi\xe1 b\xe1n"}),(0,g.jsx)("input",{type:"text",className:"form-control form-control-solid",name:"price",value:Z.price||"",onChange:function(e){Number(e.target.value)>=0&&M("price",Number(e.target.value))}})]}),(0,g.jsxs)("div",{className:"column my-3",children:[(0,g.jsx)("label",{className:"form-label required",children:"Gi\xe1 \u01b0u \u0111\xe3i"}),(0,g.jsx)("input",{type:"text",className:"form-control form-control-solid",name:"price_special",value:Z.price_special||"",onChange:function(e){0<=Number(e.target.value)&&Number(e.target.value)<=Number(Z.price)&&M("price_special",Number(e.target.value))}})]})]}),(0,g.jsxs)("div",{className:"column my-3",children:[(0,g.jsx)("label",{className:"form-label required",children:"M\xf4 t\u1ea3"}),(0,g.jsx)("input",{type:"text",className:"form-control form-control-solid",name:"short_content",value:Z.short_content,onChange:P})]}),(0,g.jsxs)("div",{className:"d-flex row-2",children:[(0,g.jsxs)("div",{className:"column  my-3",children:[(0,g.jsx)("label",{className:"form-label required",children:"Tag"}),(0,g.jsx)("div",{className:"column",children:(0,g.jsx)(a.Sp,{value:Z.tag_id,onChange:function(e){M("tag_id",e.target.value),M("category_id","")}})}),F.tag_id&&B.tag_id&&(0,g.jsx)("span",{className:"text-danger fs-8",children:B.tag_id})]}),(0,g.jsxs)("div",{className:"column  my-3",children:[(0,g.jsx)("label",{className:"form-label required",children:"Danh m\u1ee5c d\u1ecbch v\u1ee5"}),(0,g.jsx)("div",{className:"column",children:(0,g.jsx)(a.ms,{tag_id:Z.tag_id,disabled:!Z.tag_id||""===Z.tag_id,value:Z.category_id,onChange:function(e){return M("category_id",e.target.value)}})})]})]}),(0,g.jsxs)("div",{className:"d-flex justify-content-end mt-6",children:[(0,g.jsx)(m.Z,{loading:Q,type:"submit",color:"success",variant:"contained",children:"L\u01b0u"}),e&&(0,g.jsx)(m.Z,{onClick:function(){return U()},loading:G,className:"mx-2",type:"button",variant:"outlined",children:"Kh\xf4i ph\u1ee5c"})]})]})}),(0,g.jsx)(y,{}),(0,g.jsx)(k,{}),(0,g.jsx)(T,{})]})})}}}]);
//# sourceMappingURL=59.5ab251e1.chunk.js.map